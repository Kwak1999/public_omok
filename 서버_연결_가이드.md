# 서버 연결 가이드

## 🚀 서버 실행 방법

### 1단계: 서버 디렉토리로 이동
```bash
cd server
```

### 2단계: 의존성 설치 (처음 한 번만)
```bash
npm install
```

### 3단계: 서버 실행
```bash
# 일반 실행
npm start

# 또는 개발 모드 (코드 변경 시 자동 재시작)
npm run dev
```

서버가 성공적으로 실행되면 다음과 같은 메시지가 표시됩니다:
```
서버 실행 중: http://localhost:3001
```

---

## 📱 클라이언트에서 서버 연결

### 자동 연결
게임을 실행하면 자동으로 서버에 연결을 시도합니다.

1. **프론트엔드 실행**
   ```bash
   npm run dev
   ```

2. **멀티플레이어 모드 진입**
   - 게임 화면에서 **"멀티플레이어 시작"** 버튼 클릭
   - 자동으로 `http://localhost:3001`에 연결 시도

3. **연결 상태 확인**
   - 로비 화면에서 초록색 점(●)이 보이면 연결 성공
   - 빨간색 점(●)이 보이면 연결 실패

---

## 🔧 문제 해결

### 서버가 실행되지 않을 때

**문제**: `npm start` 실행 시 오류 발생

**해결 방법**:
1. Node.js가 설치되어 있는지 확인
   ```bash
   node --version
   ```
   (v16 이상 권장)

2. 포트 3001이 이미 사용 중인지 확인
   - 다른 프로그램이 포트 3001을 사용 중일 수 있습니다
   - `server.js`에서 포트 번호 변경 가능:
     ```javascript
     const PORT = process.env.PORT || 3001; // 원하는 포트로 변경
     ```

3. 의존성 재설치
   ```bash
   cd server
   rm -rf node_modules package-lock.json
   npm install
   ```

### 클라이언트가 서버에 연결되지 않을 때

**문제**: 로비에서 빨간색 점(연결 안 됨) 표시

**해결 방법**:
1. 서버가 실행 중인지 확인
   - 터미널에서 서버 로그 확인
   - `서버 실행 중: http://localhost:3001` 메시지 확인

2. 서버 URL 확인
   - 기본값: `http://localhost:3001`
   - 다른 서버를 사용하는 경우 `MultiplayerLobby.jsx`에서 수정:
     ```javascript
     const [serverUrl, setServerUrl] = useState('http://localhost:3001');
     ```

3. 방화벽 확인
   - Windows 방화벽이 포트 3001을 차단하지 않는지 확인

4. 브라우저 콘솔 확인
   - F12 → Console 탭에서 오류 메시지 확인
   - `서버 연결됨: [socket-id]` 메시지가 보여야 함

---

## 🌐 원격 서버 사용하기

다른 컴퓨터나 서버에서 실행하려면:

### 서버 설정 변경
`server/server.js`에서 CORS 설정 확인:
```javascript
const io = new Server(httpServer, {
  cors: {
    origin: "*", // 프로덕션에서는 특정 도메인으로 제한
    methods: ["GET", "POST"]
  }
});
```

### 클라이언트 설정 변경
`src/components/omok/MultiplayerLobby.jsx`에서 서버 URL 변경:
```javascript
const [serverUrl, setServerUrl] = useState('http://서버주소:3001');
```

---

## ✅ 연결 확인 체크리스트

- [ ] 서버 디렉토리로 이동 (`cd server`)
- [ ] 의존성 설치 완료 (`npm install`)
- [ ] 서버 실행 중 (`npm start`)
- [ ] "서버 실행 중: http://localhost:3001" 메시지 확인
- [ ] 프론트엔드 실행 (`npm run dev`)
- [ ] "멀티플레이어 시작" 버튼 클릭
- [ ] 로비에서 초록색 점(연결됨) 확인
- [ ] 브라우저 콘솔에서 "서버 연결됨" 메시지 확인

---

## 📝 서버 실행 명령어 요약

```bash
# 터미널 1: 서버 실행
cd server
npm install  # 처음 한 번만
npm start

# 터미널 2: 프론트엔드 실행
npm run dev
```

두 터미널을 모두 실행한 상태에서 게임을 플레이할 수 있습니다!
